# 통신/네트워크

<br>

#### TCP vs UDP

- TCP

    서버와 클라이언트 간에 데이터를 신뢰성 있게 전달하기 위해 만들어진 프로토콜이다. 데이터는 네트워크선로를 통해 전달되는 과정에서 손실되거나 순서가 뒤바뀌어서 전달될 수 있는데, TCP는 손실을 검색해내서, 이를 교정하고 순서를 재조합 할 수 있도록 해준다.

    Transmission Control Protocol의 줄임 말이다. 데이터를 전송하기 전에 데이터 전송을 위한 연결을 만드는 연결지향 프로토콜이다

- UDP는 송신 측과 수신 측의 연결을 거치지 않고 일방적으로 데이터를 보내고 데이터를 전송해도 수신으로부터 응답은 따로 받지 않는다. DNS 검색할 때 사용된다.

 <br>

#### OSI 7 계층

  통신기능을 7개의 수직계층으로 분할하여 각 계층마다 다른 계층과는 무관하게 자신의 독립적인 기능을 지원하도록 구성함. 각각의 계층을 다른 계층과 독립적으로 구성한 것은 한 모듈에 대한 변경이 전체 모듈에 미치는 영향을 최소화하기 위해서임. 즉, 일부 모듈의 변경이 있는 경우에 전체 모듈을 변경하는 대신 변경이 있는 해당 모듈만을 바꾸면 되도록 함.

  물데네전세표응

- Physical Layer - 물리계층
  - 데이터를 물리 매체상으로 전송하는 역할을 담당하는 계층으로, 전송을 위해 필 필요한 물리적 링크의 설정, 유지, 해제를 담당한다.
  - 사용자 장비와 네트워크 종단장비 사이의 물리적, 전기적인 인터페이스 규정에 초점을 두고 있으며, 전송 선로의 종류에 따라 전송방식과 인코딩 방식을 결정한 다.
  - 전송 단위는 Bit를 사용한다.
  - 단지 데이터 전달의 역할을 할 뿐이다. 

- Data-Link Layer - 데이터링크 계층
  - 전송 단위는 Frame을 사용하며 주소는 Mac을 사용한다. 
  - 물리계층의 있는 그대로의 전송설비를 신뢰할 수 있는 링크로 변환한다. 이는 상위 계층인 네트워크 계층에게 오류 없는 물리계층으로 보이도록 한다. 
  - 네트워크계층에서 정보를 받아 주소와 제어정보를 헤더와 테일에 추가한다.

- Network Layer - 네트워크 계층
  - 전송 단위는 Packet을 사용하며 주소는 IP를 사용한다. ② 송신측에서 수신측까지 데이터를 안전하게 전달하기 위해서 논리적 링크(네트워크) 를 설정 하고 상위계층 데이터를 작은 크기의 패킷으로 분할하여 전송하는 역할을 수행한다. 
  - 데이터를 목적지까지 가장 안전하고 빠르게 전달하도록 한다. -Routing 기능

- Transport Layer - 전송계층
  - 전송 단위는 Segment를 사용하며 주소는 Port를 사용한다.
  - OSI 7계층 구조는 전송계층을 기점으로 하위계층으로 이루어진 네트워크 서비 스와 상위계층으로 이루어진 사용자 서비스로 구별 될 수 있다.
  - 전체 메시지를 발신지 대 목적지 (end-to-end)간 제어와 에러를 관리한다.
  - end-to-end 전송은 단순히 한 컴퓨터에서 다음 컴퓨터로의 전달이 아니라, 송신 컴퓨터의 응용프로그램(프로세스)에서 최종 수신 컴퓨터의 응용프로그램(프로세스) 으로의 전달을 의미한다. 

- Session Layer - 세션계층
  - 전송 단위는 message이다.
  - 세션 계층은 네트워크 대화 제어기로 통신 시스템 간에 상호대화를 설정하고, 유지하고, 동기화 한다.
  - 실제 이용자의 응용프로그램 사이에서 세션이라 불리는 연결을 확립하고 유지하 며 동기화 하는 기능을 제공한다.
  - 세션계층은 표현계층으로부터 받은 데이터를 효율적인 세션 관리를 위해 짧은 데이터 단위로 나눈 후에 전송 계층으로 내려 보낸다. 

- Presentation Layer - 표현계층
  - 전송 단위는 message이다.
  - 송,수신자가 공통으로 이해 할 수 있도록 정보의 데이터 표현방식을 바꾸는 기 능을 담당한다.
  - 송신측의 표현계층은 응용계층으로부터 받은 데이터의 보안과 효율적인 전송을 위해 암호화와 압축을 수행하여 세션 계층으로 내려 보낸다.

- Application Layer – 응용계층
  - 전송 단위는 message이다.
  - 최 상위 계층으로 사용자가 네트워크에 접속하는 것을 가능하게 한다. 전자우편, 원격파일 접속과 전송 등 사용자 인터페이스를 제공한다.

  <br>

#### handshake

![handshake](https://github.com/ssyup4259/interview/blob/master/img/handshake.png?raw=true)

- 3way handshake

  - TCP의 연결을 초기화할 때 사용한다.

  -   A클라이언트는 B서버에 접속을 요청하는 SYN 패킷을 보낸다. 이 때 클라이언트는 syn을 보내고 syn/ack 응답을 기다리는 syn_sent 상태가 된다.

      서버는 syn 요청을 받고 A클라이언트에게 요청을 수락한다는 ack와 syn flag가 설정된 패킷을 발송하고 클라이언트가 다시 ack로 응답하기를 기다린다. 서버의 상태는 syn_received 상태가 된다.

      클라이언트는 서버에서 ack를 보내고 이후로부터는 연결이 이루어지고 데이터가 서로 송수신 된다. 이 때 서버의 상태는 established 이다.

- 4way handshake

  - 세션을 종료하기 위해 수행되는 절차다.

  - 클라이언트가 연결을 종료하겠다는 fin 플래그를 전송한다.

      서버는 일단 확인 메시지ACK를 보내고 자신의 통신이 끝날 때까지 기다리는데 이 상태가 Time_wait

      서버가 통신이 끝났으면 연결이 종료되었다고 클라이언트에게 fin 플래그를 전송한다.

      클라이언트는 확인했다는 메시지를 보낸다.

      만약 클라이언트가 fin을 보내기전 앞선 패킷이 늦게 왔다면 클라이언트는 서버로부터 fin을 수신하고 나서 일정시간(디폴트 240초간) 동안 세션을 남겨놓고 잉여 패킷을 기다리게 된다 이 과정을 TIME_WAIT이라한다.

